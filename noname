local magicName = tostring(game.Players.LocalPlayer.UserId).."Opened"

local function findDiamondAttribute(object)
    local attributes = object:GetAttributes()
    local tog = false
    for name, value in pairs(attributes) do
        if name == magicName and value == true then
           tog = true -- return the attribute name and value
        end
    end
    return tog
end

for i, v in pairs(workspace.Items:GetChildren()) do 
if v.Name == "Diamond" and v:FindFirstChildOfClass("MeshPart") then 
local part = v:FindFirstChildOfClass("MeshPart")
repeat 
wait()
  if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart") and part ~= nil and part.Parent ~= nil and part.Parent.Parent ~= nil  then
  game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(part.Position)
local args = {
	v
}
game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents"):WaitForChild("RequestTakeDiamonds"):FireServer(unpack(args))
end
until game.Players.LocalPlayer.Character == nil or game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart") == nil or part == nil or part.Parent == nil or part.Parent.Parent == nil 
end
end
local gTog = false
for i, v in pairs(workspace.Items:GetChildren()) do 
if v.Name == "Stronghold Diamond Chest" then
  gTog = true
  if v:FindFirstChild("Main") == nil then
    repeat 
wait()
if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")  then
  game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = v.WorldPivot
end
until v:FindFirstChild("Main")
end
 local startTime = tick() 
repeat 
wait()
  if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")  then
  game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = v.WorldPivot
local args = {
	v
}
game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents"):WaitForChild("RequestOpenItemChest"):FireServer(unpack(args))
end
until tick() - startTime >= 12 or game.Players.LocalPlayer.Character == nil or game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart") == nil or v == nil or findDiamondAttribute(v) == true
end
end

if gTog == true then
 local startTime2 = tick() 
  local hTog = false
repeat
wait()
 for i, v in pairs(workspace.Items:GetChildren()) do 
if v.Name == "Diamond" and v:FindFirstChildOfClass("MeshPart") and (v:FindFirstChildOfClass("MeshPart").Position - game.Players.LocalPlayer.Character.HumanoidRootPart.Position).Magnitude < 50 then 
hTog = true
  break
end
end
until hTog == true or tick() - startTime2 >= 3
end
wait()


for i, v in pairs(workspace.Items:GetChildren()) do 
if v.Name == "Diamond" and v:FindFirstChildOfClass("MeshPart") then 
local part = v:FindFirstChildOfClass("MeshPart")
repeat 
wait()
  if game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart") and part ~= nil and part.Parent ~= nil and part.Parent.Parent ~= nil then
  game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(part.Position)
local args = {
	v
}
game:GetService("ReplicatedStorage"):WaitForChild("RemoteEvents"):WaitForChild("RequestTakeDiamonds"):FireServer(unpack(args))
end
until game.Players.LocalPlayer.Character == nil or game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart") == nil or part == nil or part.Parent == nil or part.Parent.Parent == nil 
end
end
print("4")


-- Gui to Lua
-- Version: 3.2

-- Instances:

local NOTI = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local TextLabel = Instance.new("TextLabel")
local TextLabel_2 = Instance.new("TextLabel")

--Properties:

NOTI.Name = "NOTI"
NOTI.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")
NOTI.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
NOTI.ResetOnSpawn = false
NOTI.Enabled = true

Frame.Parent = NOTI
Frame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
Frame.BackgroundTransparency = 1.000
Frame.BorderColor3 = Color3.fromRGB(0, 0, 0)
Frame.BorderSizePixel = 0
Frame.Position = UDim2.new(0.20532915, 0, 0.158482149, 0)
Frame.Size = UDim2.new(0, 1128, 0, 611)

TextLabel.Parent = Frame
TextLabel.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
TextLabel.BackgroundTransparency = 1.000
TextLabel.BorderColor3 = Color3.fromRGB(0, 0, 0)
TextLabel.BorderSizePixel = 0
TextLabel.Position = UDim2.new(0, 0, 0.297872335, 0)
TextLabel.Size = UDim2.new(0, 1128, 0, 246)
TextLabel.Font = Enum.Font.SourceSansBold
TextLabel.Text = "FINDING SERVERS..."
TextLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TextLabel.TextSize = 100.000

local u = Instance.new("UIStroke", TextLabel)
u.Thickness = 2




TextLabel_2.Parent = Frame
TextLabel_2.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
TextLabel_2.BackgroundTransparency = 1.000
TextLabel_2.BorderColor3 = Color3.fromRGB(0, 0, 0)
TextLabel_2.BorderSizePixel = 0
TextLabel_2.Position = UDim2.new(0, 0, 0.389525354, 0)
TextLabel_2.Size = UDim2.new(0, 1128, 0, 246)
TextLabel_2.Font = Enum.Font.SourceSans
TextLabel_2.Text = "Not every server will have diamonds"
TextLabel_2.TextColor3 = Color3.fromRGB(255, 255, 255)
TextLabel_2.TextSize = 35.000

local u = Instance.new("UIStroke", TextLabel_2)
u.Thickness = 2
local TeleportService = game:GetService("TeleportService")
local Players = game:GetService("Players")

-- Teleports you into a *different* server of the same game
TeleportService:Teleport(game.PlaceId, Players.LocalPlayer)
